---
layout: post
title: "OKR读书笔记"
date:   2024-09-07
tags: [OKR]
comments: true
author: xy
# toc: true  # 这里加目录导致看到地方太小了
---

本文主要内容如下:

1. 为什么需要系统的看下`OKR`相关的书籍?

    1.1 整体架构以及各模块功能

2. `NameServer`源代码介绍包括:

    2.1 代码结构介绍

    2.2 启动类 `NamesrvController` 的核心流程


### 1.1 整体架构以及各模块功能



四个核心组件：



### 1.2 为何写`NameServer`而没用 `zookeeper`




### 2.1 代码结构介绍

Namesvr的代码结构如下:

```java
namesrv
    ├─ NamesrvController.java  // 执行初始化逻辑，加载配置、注册Processor等
    ├─ NamesrvStartup.java     // NameServer的启动类, 启动netty server
    ├─ kvconfig
    │    ├─ KVConfigManager.java       // namespace和config配置管理
    │    └─ KVConfigSerializeWrapper.java // 将获取到的配置json序列化
    ├─ processor
    │    ├─ ClusterTestRequestProcessor.java // rpc请求处理(如: broker注册,拉取节点信息)
    │    └─ DefaultRequestProcessor.java  // 默认地请求处理器, 处理数据包
    └─ routeinfo
    ├─--- BrokerHousekeepingService.java // netty 的channel共用方法抽象
    └─--- RouteInfoManager.java   // 路由管理器，维护topic, broker,
```

### 2.2 启动 `NamesrvController`



### 2.4 `broker` 路由管理



注册的代码主逻辑(读写锁保证线程安全):



### 参考



